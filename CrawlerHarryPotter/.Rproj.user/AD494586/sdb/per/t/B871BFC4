{
    "collab_server" : "",
    "contents" : "library(Rcrawler)\n#Ejemplo de una afiliacion\nRcrawler(\"https://www.pottermore.com/collection/characters-gryffindors\",MaxDepth = 1,\n               ExtractXpathPat =c(\"/html/body/article[1]/div[1]/header/hgroup/div/h1\",\n                                   \"/html/body/article[1]/div[2]/div/div[1]/div[2]/div/p\",\n                                  \"//img/@data-src\"),\n               RequestsDelay = 5,PatternsName = c(\"Nombre\", \"Descripción\",\"Imagen\"))\n\nvectorNombre = unlist(lapply(DATA, `[[`, 1))\nvectorDesc = unlist(lapply(DATA, `[[`, 2))\nvectorImg = unlist(lapply(DATA, `[[`, 3))\nvectorCasa = rep(\"Griffindor\",length(vectorNombre))\n\ndatosTotales = data.frame(Nombre = vectorNombre, \n                          Descripcion = vectorDesc, \n                          Afiliacion = vectorCasa,\n                          Imagen = vectorImg)\ndatosTotales = datosTotales[complete.cases(datosTotales),]\n\nRcrawler(\"https://www.pottermore.com/collection/characters-ravenclaws\",MaxDepth = 1,\n               ExtractXpathPat =c(\"/html/body/article[1]/div[1]/header/hgroup/div/h1\",\n                                  \"/html/body/article[1]/div[2]/div/div[1]/div[2]/div/p\",\n                                  \"//img/@data-src\"),\n               RequestsDelay = 5,PatternsName = c(\"Nombre\", \"Descripción\",\"Imagen\"))\n\nvectorNombre = unlist(lapply(DATA, `[[`, 1))\nvectorDesc = unlist(lapply(DATA, `[[`, 2))\nvectorImg = unlist(lapply(DATA, `[[`, 3))\nvectorCasa = rep(\"Ravenclaw\",length(vectorNombre))\n\ndatosTotales = rbind(datosTotales,\n                     data.frame(Nombre = vectorNombre, \n                                Descripcion = vectorDesc, \n                                Afiliacion = vectorCasa,\n                                Imagen = vectorImg))\n\nRcrawler(\"https://www.pottermore.com/collection/characters-hufflepuffs\",MaxDepth = 1,\n               ExtractXpathPat =c(\"/html/body/article[1]/div[1]/header/hgroup/div/h1\",\n                                  \"/html/body/article[1]/div[2]/div/div[1]/div[2]/div/p\",\n                                  \"//img/@data-src\"),\n               RequestsDelay = 5,PatternsName = c(\"Nombre\", \"Descripción\",\"Imagen\"))\n\nvectorNombre = unlist(lapply(DATA, `[[`, 1))\nvectorDesc = unlist(lapply(DATA, `[[`, 2))\nvectorImg = unlist(lapply(DATA, `[[`, 3))\nvectorCasa = rep(\"Hufflepuff\",length(vectorNombre))\n\ndatosTotales = rbind(datosTotales,\n                     data.frame(Nombre = vectorNombre, \n                                Descripcion = vectorDesc, \n                                Afiliacion = vectorCasa,\n                                Imagen = vectorImg))\ndatosTotales = datosTotales[complete.cases(datosTotales),]\n\n\nRcrawler(\"https://www.pottermore.com/collection/characters-slytherins\",MaxDepth = 1,\n         ExtractXpathPat =c(\"/html/body/article[1]/div[1]/header/hgroup/div/h1\",\n                            \"/html/body/article[1]/div[2]/div/div[1]/div[2]/div/p\",\n                            \"//img/@data-src\"),\n         RequestsDelay = 5,PatternsName = c(\"Nombre\", \"Descripción\",\"Imagen\"))\n\nvectorNombre = unlist(lapply(DATA, `[[`, 1))\nvectorDesc = unlist(lapply(DATA, `[[`, 2))\nvectorImg = unlist(lapply(DATA, `[[`, 3))\nvectorCasa = rep(\"Slytherin\",length(vectorNombre))\n\ndatosTotales = rbind(datosTotales,\n                     data.frame(Nombre = vectorNombre, \n                                Descripcion = vectorDesc, \n                                Afiliacion = vectorCasa,\n                                Imagen = vectorImg))\ndatosTotales = datosTotales[complete.cases(datosTotales),]\n\nwrite.csv(datosTotales, \"datos.csv\", row.names = F)\n\n\n#Quitar libros\ndatosTotales = datosTotales[which(!datosTotales$Nombre %in% c(\"Fantastic Beasts and Where to Find Them\",\n                                                             \"Harry Potter and the Cursed Child\")),]\n\n\n#pruebas de scraping\nejemplo = ContentScraper(\"https://www.pottermore.com/collection/characters\",\n               CssPatterns = c(\".collection-artefact__description\"),\n               ManyPerPattern = T, PatternsName = c(\"Grupo\"))\n\nurl = \"https://www.pottermore.com/explore-the-story/minerva-mcgonagall\"\nurl = \"https://www.pottermore.com/explore-the-story/harry-potter\"\nejemploPagChar = ContentScraper(url,\n                                XpathPatterns = c(\"/html/body/article[1]/div[1]/header/hgroup/div/h1\",\n                                                  \"/html/body/article[1]/div[2]/div/div[1]/div[2]/div/p\",\n                                                  \"//img/@data-src\"),\n                                PatternsName = c(\"Nombre\", \"Descripción\", \"Imagen\"))\n\"/html/body/article[1]/div[2]/div/div[1]/div[1]/div/picture/img\"\nejemploPagChar$Imagen\n\nfor(i in length(datosTotales)){\n  datosTotales[,i] = as.character(datosTotales[,i])\n}\ndatosTotales[,3] = as.character(datosTotales[,3])\n\n#imprimir en formato JSON\nlibrary(RJSONIO)\ncasas = unique(datosTotales$Afiliacion)\nlistaCasas = list()\nfor(i in casas){\n  listaPersonajes = list()\n  personajes = datosTotales[datosTotales$Afiliacion == i,]\n  for(j in 1:nrow(personajes)){\n    listaPersonajes = append(listaPersonajes,\n                             list(list(name = personajes$Nombre[j],\n                                  descripcion =personajes$Descripcion[j],\n                                  imagen = personajes$Imagen)))\n  }\n  listaCasas = append(listaCasas,list(list(name = i,\n                                       children = listaPersonajes)))\n}\nlistaHogwarts = list(name = \"Hogwarts\", children = listaCasas)\nwrite(toJSON(listaHogwarts,pretty= T),file = \"hogwartsHouseTree.json\")\n",
    "created" : 1509662871530.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "2700074396",
    "id" : "B871BFC4",
    "lastKnownWriteTime" : 1509740467,
    "last_content_update" : 1509740467,
    "path" : "D:/Dropbox/documentos/Visual Analytics/Tarea4.5/CrawlerHarryPotter/crawler.R",
    "project_path" : "crawler.R",
    "properties" : {
    },
    "relative_order" : 1,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_source"
}